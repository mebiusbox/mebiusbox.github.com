---
title: WindowsでのPython環境について
description: Anacondaから別の環境に移行できるのか
keywords:
  - anaconda
  - miniconda
  - python
  - pyenv
  - poetry
  - rye
  - uv
category: note
authors: [mebiusbox]
tags: [windows,python]
image: https://og-image-mebiusbox.vercel.app/api/og?title=Windows%e3%81%a7%e3%81%aePython%e7%92%b0%e5%a2%83%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6&subtitle=Anaconda%e3%81%8b%e3%82%89%e5%88%a5%e3%81%ae%e7%92%b0%e5%a2%83%e3%81%ab%e7%a7%bb%e8%a1%8c%e3%81%a7%e3%81%8d%e3%82%8b%e3%81%ae%e3%81%8b&date=2024%2F08%2F27&tags=windows,python
---

WindowsでのPython環境はこれまでMiniconda(Anaconda)を利用してきました．個人的利用では正直なところ、とくに問題ありません．ただ、現在Minicondaを利用する理由がPythonとNodejsのバージョン管理にしか使っておらず、そろそろ別のに乗り換えるいい機会かなと思いました．そこで、いくつか試してみた結果を記録しておきます．

<!-- truncate -->

結論から言うと、やはりMinicondaが楽かなと思います．情報量も多いですし．ただ、最終的に py + winget + pip/uv + nvm という環境になりました．
まずは他に試したものからまとめていきます．

## pyenv + poetry

Windowsだと [pyenv-win](https://github.com/pyenv-win/pyenv-win) を使います．インストールや初期設定など若干手間ではありますが、導入に関しては問題ありませんでした．ただ、pyenv経由でインストールしたpythonの動作が公式インストーラでのpythonや他のpythonバージョン管理での実行バイナリと挙動が違っていました．もちろん、それぞれ同じバージョンなのですが、ビルドはそれぞれ違います．pyenvでインストールしたバイナリだと結果がエラーになってしまう部分があり、こちらの環境で問題が発生しました．具体的には "-c" コマンドを空で実行したときに返ってくる結果が異なります．こちらのコードを調整すれば対応できますが、クローンしたプロジェクトで発生しており、ちょっと面倒なため、残念ながら不採用となりました．pyenvそのものはとくに問題なかったのですけどね．あと、poetryに関してもとくに問題ないと思います．しかし、uv があまりにも速かったのでそちらにしました．

## Rye

[Rye](https://rye.astral.sh/) はPythonのバージョン、およびパッケージ、プロジェクトを管理できるツールです．これから新規にやっていくならありかなと思いますが、試してみて思ったのがすでにある環境への対応が難しいです．とくにpipコマンドが隠蔽されてしまうのが致命的で、環境の構築など簡単に実行できるスクリプトなどが用意されていることも多く、こういったスクリプトがまったく動かなくなります．ちなみに、pipコマンドが隠蔽されることは別に悪いことではなく、rye経由のパッケージ管理に集中できます．

## uv

[uv](https://github.com/astral-sh/uv) はパッケージとプロジェクト管理ツールです．Pythonのバージョン管理もあります．
とにかく仮想環境の構築が速いです．Ryeも標準でuvを使うようになっています．使い方も `uv pip ...` と pip に準拠した形になっているので移行しやすいです．
非常に魅力的なツールではありますが、まだまだ実験的な機能が多く、安定するには時間がかかるかもしれません．
また、pipでインストールすると問題なかったものが uv だと上手く動作しなかったことが1度だけありました．依存解決の仕方が違うようなのでそういったことが起こることがあるようです．ただ、それでも仮想環境の構築やパッケージのインストールが速いので、とりあえず uv で構築して、問題が起きたら pip にするようにしています．

## py

py はPythonランチャーのことで、公式インストーラを使うとインストールされます．py はインストールされているPythonのバイナリを実行時に指定できます．
なので、複数のバージョンをインストールして py でバージョンを切り替えて使うということになります．各バージョンについては winget を使うことで簡単にインストールできますので、py+winget でPythonのバージョン管理ができます．また、一部のWindowsアプリはPythonによるスクリプト実行ができるのですが、グローバルにインストールしていると設定が楽だったりします．

## py + winget + pip (uv)

ということで、最終的に py + winget で python のバージョン管理を、pip/uv でパッケージ管理をするようになりました．とりあえず、ローカルにある環境はほとんど Miniconda から移行できました．ちなみに基本的に pyproject.toml に依存関係をまとめて uv を使ったり、pip を使う場合は uv で pyproject.toml から requirements.txt を生成して使うという形になります．あと、パッケージの依存関係を調べるのに `uv pip tree` コマンドが使えるので便利です．また、poetry も使ってもいいかもしれません．それはもうちょっと試してみないとわからないです．

環境は移行したものの、Miniconda よりも良くなったというところはとくにないので、Miniconda(Anaconda)を使ってもいいと思います．py+winget の部分が Miniconda になるだけです．とりあえず、どちらでも好きな方で問題ないという認識です．

以上です．
